<!DOCTYPE HTML>
<html lang="en">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
<title>LayerSwipe Dijit</title>
<link rel="stylesheet" type="text/css" href="http://js.arcgis.com/3.9/js/esri/css/esri.css">
<link rel="stylesheet" type="text/css" href="http://js.arcgis.com/3.9/js/dojo/dijit/themes/claro/claro.css">
<link rel="stylesheet" type="text/css" href="css/LayerSwipe.css">
<style>
    body{
        margin:40px;
        padding:20px;
    }
    .container{
        position:relative;
        padding: 10px;
        border: 1px solid #eee;
        -webkit-border-radius: 3px;
        border-radius: 3px;
        margin-bottom:20px;
    }
    #map{
        width:100%;
        height: 500px;
        position: relative;
    }
    .changeTool{
        list-style: none;
        padding: 0;
        margin: 0;
        float:right;
    }
    .changeTool li{
        margin: 0;
        float: left;
        margin-right: 10px;
        padding: 6px 0;
    }
    .buttonItem{
        text-decoration: underline;
        color:#457ee9;
        display: inline-block;
        padding: 6px 0;
        cursor: pointer;
        margin-right: 10px;
    }
    .buttonItem:hover{
        color:black;
        text-decoration: none;
    }
</style>
</head>
<body class="claro">
<h1>LayerSwipe Dijit</h1>
<div class="container">
	<div id="map" class="map">
		<div id="LayerSwipe">
		</div>
	</div>
</div>
<div class="buttonItem" id="toggleLTR">
	Toggle ltr
</div>
<div class="buttonItem" id="toggleTTB">
	Toggle ttb
</div>
<div class="buttonItem" id="toggleLayer">
	Toggle Layer Visibility
</div>
<div class="buttonItem" id="toggleEnabled">
	Toggle Widget Enabled
</div>
<div class="buttonItem" id="toggleStartup">
	Destroy
</div>
<ul class="changeTool">
	<li><input id="vTool" type="radio" name="type" value="vertical" checked="checked"/><label for="vTool">Vertical</label></li>
	<li><input id="hTool" type="radio" name="type" value="horizontal"/><label for="hTool">Horizontal</label></li>
	<li><input id="sTool" type="radio" name="type" value="scope"/><label for="sTool">Scope</label></li>
</ul>
<div style="clear:both;">
</div>
<script src="https://gist.github.com/driskull/5995588.js"></script>
<h2>All Options</h2>
<script src="https://gist.github.com/driskull/5995582.js"></script>
<script type="text/javascript">
    var package_path = window.location.pathname.substring(0, window.location.pathname.lastIndexOf('/'));
    var dojoConfig = {
        // The locationPath logic below may look confusing but all its doing is 
        // enabling us to load the api from a CDN and load local modules from the correct location.
        packages: [{
            name: "application",
            location: package_path + '/js'
        }]
    };
</script>
<script src="http://js.arcgis.com/3.9/" type="text/javascript"></script>
<script type="text/javascript">
        var swipeWidget, map;
        require(["dojo/_base/lang", "esri/map", "application/LayerSwipe", "esri/arcgis/utils", "dojo/on", "dojo/dom", "dojo/query"], function(lang, Map, LayerSwipe, arcgisUtils, on, dom, query){
            arcgisUtils.createMap('b087539934df47429b7c315760588b19', "map", {
                mapOptions: {
                    //Optionally define additional map config here for example you can 
                    //turn the slider off, display info windows, disable wraparound 180, slider position and more. 
                }
            }).then(lang.hitch(this, function (response) {
                map = response.map;
                // getting layer id by title
                var title = "World Imagery";
                var id;
                var layers = response.itemInfo.itemData.operationalLayers;
                if (layers.length) {
                    for (var i = 0; i < layers.length; i++) {
                        if (layers[i].title === title) {
                            id = layers[i].id;
                            if(layers[i].featureCollection && layers[i].featureCollection.layers.length){
                                id = layers[i].featureCollection.layers[0].id;
                            }
                            break;
                        }
                    }
                }
                // get layer by id
                var layer = map.getLayer(id);
                swipeWidget = new LayerSwipe({
                    type: "vertical",
                    map: map,
                    layers: [layer]
                }, "LayerSwipe");
                swipeWidget.startup();
                on(dom.byId('toggleLTR'), 'click', function(){
                    swipeWidget.set("ltr", !swipeWidget.get("ltr")); 
                });
                on(dom.byId('toggleTTB'), 'click', function(){
                    swipeWidget.set("ttb", !swipeWidget.get("ttb")); 
                });
                on(dom.byId('toggleLayer'), 'click', function(){
                    layer.setVisibility(!layer.visible);
                });
                on(dom.byId('toggleEnabled'), 'click', function(){
                    swipeWidget.set("enabled", !swipeWidget.get("enabled")); 
                });
                
                
                on(dom.byId('toggleStartup'), 'click', function(){
                    if(swipeWidget){
                        swipeWidget.destroy();
                        swipeWidget = null;
                    }
                    else{
                        swipeWidget = new LayerSwipe({
                            type: "vertical",
                            map: map,
                            layers: [layer]
                        }, "LayerSwipe");
                        swipeWidget.startup();    
                    }
                });
            
                
                on(query("input[name=type]"), 'change', function(evt){
                    swipeWidget.set("type", evt.target.value);
                });
                
                on(swipeWidget, 'swipe', function(obj){
                    console.log(obj);
                });
                
            }), lang.hitch(this, function (error) {
                //an error occurred - notify the user. In this example we pull the string from the 
                //resource.js file located in the nls folder because we've set the application up 
                //for localization. If you don't need to support mulitple languages you can hardcode the 
                //strings here and comment out the call in index.html to get the localization strings. 
                if (this.config && this.config.i18n) {
                    alert(this.config.i18n.map.error + ": " + error.message);
                } else {
                    alert("Unable to create map: " + error.message);
                }
            }));
        });
    </script>
</body>
</html>
